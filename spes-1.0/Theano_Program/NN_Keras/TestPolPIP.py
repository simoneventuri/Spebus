import numpy

NOrd = 10
R    = numpy.array([1.0,2.0,7.0]) * 0.529177


LambdaVec = numpy.array([[0.8064516129, 0.8064516129, 0.8064516129], [0.5586592179, 0.5586592179, 0.5586592179]])
reVec     = numpy.array([[1.18, 1.18, 1.18], [1.11, 1.11, 1.11]])
W         = numpy.array([-0.101038755197e+03,-0.173846060523e+04,0.182561485864e+04,0.128228081972e+05,0.131286683935e+04,-0.180148145918e+05,
                          0.917232862414e+04,-0.898548422285e+05,0.236443117836e+04,0.743556379026e+05,0.169485321184e+06,-0.658211759764e+05,
                          0.293154900522e+06,0.310179195421e+05,-0.174367178858e+05,-0.171278144114e+06,-0.196708992219e+06,0.135370348197e+06,
                          0.126786481833e+06,-0.483041955100e+06,-0.421201296092e+05,0.133523045430e+05,0.237659552123e+06,-0.351906377925e+05,
                          0.376297007075e+06,-0.149922827153e+06,-0.141832776431e+06,0.428298060452e+06,0.338495737904e+05,0.486620284500e+05,
                          0.247392770653e+04,-0.195510275257e+06,-0.507721539659e+05,0.126435459710e+05,-0.227222097390e+05,-0.255415567632e+06,
                          0.145033029297e+06,0.640437783008e+05,-0.193559554130e+06,-0.142880796980e+05,-0.368068499717e+05,-0.446680420671e+04,
                          0.873374592726e+05,0.239902768734e+05,-0.108935637797e+06,0.564785581551e+05,0.124730127388e+05,0.288994701384e+05,
                          -0.542994079358e+05,-0.387502623052e+04,0.341436319238e+05,-0.358667851341e+04,0.690127419637e+04,0.966576122637e+04,
                          0.842319423210e+03,-0.162693146596e+05,-5.211261170061054])        

p0 = numpy.exp( - LambdaVec[0,0] * (R[0] - reVec[0,0]) - LambdaVec[1,0] * (R[0] - reVec[1,0])**2 )
p1 = numpy.exp( - LambdaVec[0,1] * (R[1] - reVec[0,1]) - LambdaVec[1,1] * (R[1] - reVec[1,1])**2 )
p2 = numpy.exp( - LambdaVec[0,2] * (R[2] - reVec[0,2]) - LambdaVec[1,2] * (R[2] - reVec[1,2])**2 )


IdxVecs = IdxVecs  =   [[1,1,0], 
                        [1,1,1], [2,1,0], 
                        [2,1,1], [2,2,0], [3,1,0],        
                        [2,2,1], [3,1,1], [3,2,0], [4,1,0], 
                        [2,2,2], [3,2,1], [4,1,1], [3,3,0], [4,2,0], [5,1,0], 
                        [3,2,2], [3,3,1], [4,2,1], [5,1,1], [4,3,0], [5,2,0], [6,1,0], 
                        [3,3,2], [4,2,2], [4,3,1], [5,2,1], [6,1,1], [4,4,0], [5,3,0], [6,2,0], [7,1,0],    
                        [3,3,3], [4,3,2], [4,4,1], [5,2,2], [5,3,1], [6,2,1], [7,1,1], [5,4,0], [6,3,0], [7,2,0], [8,1,0], 
                        [4,3,3], [4,4,2], [5,3,2], [5,4,1], [6,2,2], [6,3,1], [7,2,1], [8,1,1], [5,5,0], [6,4,0], [7,3,0], [8,2,0], [9,1,0],            
                        [4,4,3], [5,3,3], [5,4,2], [5,5,1], [6,3,2], [6,4,1], [6,5,0], [7,2,2], [7,3,1], [7,4,0], [8,2,1], [8,3,0], [9,1,1], [9,2,0], [10,1,0], 
                        [4,4,4], [5,4,3], [5,5,2], [6,4,2], [6,5,1], [6,6,0], [7,3,2], [7,4,1], [7,5,0], [8,2,2], [8,3,1], [8,4,0], [9,2,1], [9,3,0], [10,1,1], [10,2,0], [11,1,0], 
                        [5,4,4], [6,4,4], [6,5,2], [6,4,2], [6,6,1], [7,3,3], [7,4,2], [7,5,1], [8,3,2], [8,4,1], [8,5,0], [9,2,2], [9,3,1], [9,4,0], [10,2,1], [10,3,0], [11,2,0], [11,1,1], [12,1,0], 
                        [5,5,4], [6,3,5], [6,4,4], [7,3,4], [7,5,2], [7,6,1], [7,7,0], [8,3,3], [8,4,2], [8,5,1], [8,6,0], [9,3,2], [9,4,1], [9,5,0], [10,2,2], [10,3,1], [10,4,0], [11,2,1], [11,3,0], [12,2,0], [13,1,0],
                       ] 

PermVecs =  [2,
             6, 1,
             2, 2, 1,
             2, 2, 1, 1,
             6, 1, 2, 2, 1, 1,
             2, 2, 1, 2, 1, 1, 1,
             2, 2, 1, 1, 2, 2, 1, 1, 1,
             6, 1, 2, 2, 1, 1, 2, 1, 1, 1, 1,
             2, 2, 1, 1, 2, 1, 1, 2, 2, 1, 1, 1, 1,
             2, 2, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1,
             6, 1, 2, 1, 1, 2, 1, 1, 1, 2, 1, 1, 1, 1, 2, 1, 1,
             2, 2, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1,
             2, 1, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1]

NbVecs = numpy.array([1,0,1,2,3,4,6,7,9,11,13,15,17,19,21]) 


Sum  = numpy.zeros((1,1))
Temp = W * 0.0
iCum = 0
for iOrd in range(2, NOrd+1):
    for iIdx in range(NbVecs[iOrd]):
        IdxVec = IdxVecs[iCum]
        Temp[iCum] = (p0**IdxVec[0] * p1**IdxVec[1] * p2**IdxVec[2] + 
                      p0**IdxVec[0] * p1**IdxVec[2] * p2**IdxVec[1] + 
                      p0**IdxVec[1] * p1**IdxVec[0] * p2**IdxVec[2] + 
                      p0**IdxVec[1] * p1**IdxVec[2] * p2**IdxVec[0] + 
                      p0**IdxVec[2] * p1**IdxVec[0] * p2**IdxVec[1] + 
                      p0**IdxVec[2] * p1**IdxVec[1] * p2**IdxVec[0]) / PermVecs[iCum]
        Sum    = Sum + W[iCum] * Temp[iCum]
        #print('W1 = ', W[iCum], '; Tempp = ', Temp[iCum], '; Sum = ', Sum)
        iCum = iCum + 1

V = Sum * 0.159360144e-2*27.2113839712790
V - W[iCum]

#